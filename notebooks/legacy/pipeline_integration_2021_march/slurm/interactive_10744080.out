['00_6_run_GPU_methods.py', '11']
pytorch + cuda
1.8.0
2.7.0
scgen
# of detected devices 2
0 /device:CPU:0
1 /device:GPU:0
query 11
method                                                   scgen_E25
hvg                                                           3000
cell_type_key                                            cell.type
input            /lustre/groups/ml01/workspace/ignacio.ibarra/t...
output           /lustre/groups/ml01/workspace/ignacio.ibarra/t...
nepochs                                                       25.0
nlayers                                                        NaN
nhidden                                                        NaN
Name: 11, dtype: object
# epochs 25.0
True /lustre/groups/ml01/workspace/ignacio.ibarra/theislab/retinal_scRNAseq_integration/data/integration_march_2021/output/retinal_all_cells_Chenfixed+Hackney_batch_donor_dataset_cell.type/prepare/unscaled/HVG.3K/adata_pre.h5ad
False /lustre/groups/ml01/workspace/ignacio.ibarra/theislab/retinal_scRNAseq_integration/data/integration_march_2021/output/retinal_all_cells_Chenfixed+Hackney_batch_donor_dataset_cell.type/integration/unscaled/HVG.3K/scgen_E25.h5ad

False /lustre/groups/ml01/workspace/ignacio.ibarra/theislab/retinal_scRNAseq_integration/data/integration_march_2021/output/retinal_all_cells_Chenfixed+Hackney_batch_donor_dataset_cell.type/integration/unscaled/HVG.3K/scgen_E25_embed.csv
reading input...
location of scripts...
<module 'scIB.integration' from '/home/icb/ignacio.ibarra/miniconda3/envs/scIB-python/lib/python3.7/site-packages/scIB/integration.py'>
(568985, 3000)
scgen
# of detected devices 2
0 /device:CPU:0
1 /device:GPU:0
GPU device found True 1
1 /device:GPU:0
starting scgen
here...
importing scgen
batch key batch_donor_dataset
celltype key cell.type
Index(['batch', 'dataset', 'filename', 'nCount_RNA', 'nFeature_RNA',
       'scpred_AC', 'scpred_Astrocyte', 'scpred_BC', 'scpred_Cone',
       'scpred_HC', 'scpred_MG', 'scpred_Microglia', 'scpred_RGC',
       'scpred_RPE', 'scpred_Rod', 'scpred_max', 'scpred_prediction',
       'size_factors', 'cell.type', 'batch.merged', 'donor',
       'batch_donor_dataset'],
      dtype='object')
True
Num GPUs Available:  1
name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 32501137408
locality {
  bus_id: 2
  numa_node: 1
  links {
  }
}
incarnation: 3569363027315443342
physical_device_desc: "device: 0, name: NVIDIA Tesla V100S-PCIE-32GB, pci bus id: 0000:d8:00.0, compute capability: 7.0"
xla_global_id: 416903419

[34mINFO    [0m Using batches from adata.obs[1m[[0m[32m"batch_donor_dataset"[0m[1m][0m                    
[34mINFO    [0m Using labels from adata.obs[1m[[0m[32m"cell.type"[0m[1m][0m                               
[34mINFO    [0m Using data from adata.X                                                
[34mINFO    [0m Computing library size prior per batch                                 
[34mINFO    [0m Successfully registered anndata object containing [1;36m568985[0m cells, [1;36m3000[0m   
         vars, [1;36m46[0m batches, [1;36m11[0m labels, and [1;36m0[0m proteins. Also registered [1;36m0[0m extra   
         categorical covariates and [1;36m0[0m extra continuous covariates.              
[34mINFO    [0m Please do not further modify adata until model is trained.             
training..
Training:   0%|          | 0/25 [00:00<?, ?it/s]Epoch 1/25:   0%|          | 0/25 [00:00<?, ?it/s]Epoch 1/25:   4%|â–         | 1/25 [01:58<47:22, 118.44s/it]Epoch 1/25:   4%|â–         | 1/25 [01:58<47:22, 118.44s/it, loss=124, v_num=1]Epoch 1/25:   4%|â–         | 1/25 [02:00<47:22, 118.44s/it, loss=124, v_num=1]Epoch 2/25:   4%|â–         | 1/25 [02:06<47:22, 118.44s/it, loss=124, v_num=1]Epoch 2/25:   8%|â–Š         | 2/25 [04:11<48:40, 126.99s/it, loss=124, v_num=1]Epoch 2/25:   8%|â–Š         | 2/25 [04:11<48:40, 126.99s/it, loss=119, v_num=1]Epoch 2/25:   8%|â–Š         | 2/25 [04:13<48:40, 126.99s/it, loss=119, v_num=1]Epoch 3/25:   8%|â–Š         | 2/25 [04:20<48:40, 126.99s/it, loss=119, v_num=1]Epoch 3/25:  12%|â–ˆâ–        | 3/25 [06:24<47:38, 129.93s/it, loss=119, v_num=1]Epoch 3/25:  12%|â–ˆâ–        | 3/25 [06:24<47:38, 129.93s/it, loss=123, v_num=1]Epoch 3/25:  12%|â–ˆâ–        | 3/25 [06:27<47:38, 129.93s/it, loss=123, v_num=1]Epoch 4/25:  12%|â–ˆâ–        | 3/25 [06:33<47:38, 129.93s/it, loss=123, v_num=1]Epoch 4/25:  16%|â–ˆâ–Œ        | 4/25 [08:37<45:54, 131.18s/it, loss=123, v_num=1]Epoch 4/25:  16%|â–ˆâ–Œ        | 4/25 [08:37<45:54, 131.18s/it, loss=121, v_num=1]Epoch 4/25:  16%|â–ˆâ–Œ        | 4/25 [08:40<45:54, 131.18s/it, loss=121, v_num=1]Epoch 5/25:  16%|â–ˆâ–Œ        | 4/25 [08:46<45:54, 131.18s/it, loss=121, v_num=1]Epoch 5/25:  20%|â–ˆâ–ˆ        | 5/25 [10:51<44:01, 132.06s/it, loss=121, v_num=1]Epoch 5/25:  20%|â–ˆâ–ˆ        | 5/25 [10:51<44:01, 132.06s/it, loss=116, v_num=1]Epoch 5/25:  20%|â–ˆâ–ˆ        | 5/25 [10:53<44:01, 132.06s/it, loss=116, v_num=1]Epoch 6/25:  20%|â–ˆâ–ˆ        | 5/25 [10:59<44:01, 132.06s/it, loss=116, v_num=1]Epoch 6/25:  24%|â–ˆâ–ˆâ–       | 6/25 [13:04<41:56, 132.44s/it, loss=116, v_num=1]Epoch 6/25:  24%|â–ˆâ–ˆâ–       | 6/25 [13:04<41:56, 132.44s/it, loss=118, v_num=1]Epoch 6/25:  24%|â–ˆâ–ˆâ–       | 6/25 [13:06<41:56, 132.44s/it, loss=118, v_num=1]Epoch 7/25:  24%|â–ˆâ–ˆâ–       | 6/25 [13:13<41:56, 132.44s/it, loss=118, v_num=1]Epoch 7/25:  28%|â–ˆâ–ˆâ–Š       | 7/25 [15:18<39:49, 132.76s/it, loss=118, v_num=1]Epoch 7/25:  28%|â–ˆâ–ˆâ–Š       | 7/25 [15:18<39:49, 132.76s/it, loss=119, v_num=1]Epoch 7/25:  28%|â–ˆâ–ˆâ–Š       | 7/25 [15:20<39:49, 132.76s/it, loss=119, v_num=1]Epoch 8/25:  28%|â–ˆâ–ˆâ–Š       | 7/25 [15:26<39:49, 132.76s/it, loss=119, v_num=1]Epoch 8/25:  32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [17:31<37:42, 133.06s/it, loss=119, v_num=1]Epoch 8/25:  32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [17:31<37:42, 133.06s/it, loss=117, v_num=1]Epoch 8/25:  32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [17:34<37:42, 133.06s/it, loss=117, v_num=1]Epoch 9/25:  32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [17:40<37:42, 133.06s/it, loss=117, v_num=1]Epoch 9/25:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [19:45<35:31, 133.25s/it, loss=117, v_num=1]Epoch 9/25:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [19:45<35:31, 133.25s/it, loss=119, v_num=1]Epoch 9/25:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [19:47<35:31, 133.25s/it, loss=119, v_num=1]Epoch 10/25:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [19:53<35:31, 133.25s/it, loss=119, v_num=1]Epoch 10/25:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [21:59<33:21, 133.42s/it, loss=119, v_num=1]Epoch 10/25:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [21:59<33:21, 133.42s/it, loss=116, v_num=1]Epoch 10/25:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [22:01<33:21, 133.42s/it, loss=116, v_num=1]Epoch 11/25:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [22:07<33:21, 133.42s/it, loss=116, v_num=1]Epoch 11/25:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [24:12<31:07, 133.38s/it, loss=116, v_num=1]Epoch 11/25:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [24:12<31:07, 133.38s/it, loss=116, v_num=1]Epoch 11/25:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [24:14<31:07, 133.38s/it, loss=116, v_num=1]Epoch 12/25:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [24:21<31:07, 133.38s/it, loss=116, v_num=1]Epoch 12/25:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [26:26<28:55, 133.54s/it, loss=116, v_num=1]Epoch 12/25:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [26:26<28:55, 133.54s/it, loss=116, v_num=1]Epoch 12/25:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [26:28<28:55, 133.54s/it, loss=116, v_num=1]Epoch 13/25:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [26:35<28:55, 133.54s/it, loss=116, v_num=1]Epoch 13/25:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [28:40<26:44, 133.67s/it, loss=116, v_num=1]Epoch 13/25:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [28:40<26:44, 133.67s/it, loss=115, v_num=1]Epoch 13/25:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [28:42<26:44, 133.67s/it, loss=115, v_num=1]Epoch 14/25:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [28:48<26:44, 133.67s/it, loss=115, v_num=1]Epoch 14/25:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [30:54<24:29, 133.63s/it, loss=115, v_num=1]Epoch 14/25:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [30:54<24:29, 133.63s/it, loss=121, v_num=1]Epoch 14/25:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [30:56<24:29, 133.63s/it, loss=121, v_num=1]Epoch 15/25:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [31:02<24:29, 133.63s/it, loss=121, v_num=1]Epoch 15/25:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [33:07<22:17, 133.71s/it, loss=121, v_num=1]Epoch 15/25:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [33:07<22:17, 133.71s/it, loss=117, v_num=1]Epoch 15/25:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [33:10<22:17, 133.71s/it, loss=117, v_num=1]Epoch 16/25:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [33:16<22:17, 133.71s/it, loss=117, v_num=1]Epoch 16/25:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [35:21<20:03, 133.69s/it, loss=117, v_num=1]Epoch 16/25:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [35:21<20:03, 133.69s/it, loss=117, v_num=1]Epoch 16/25:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [35:23<20:03, 133.69s/it, loss=117, v_num=1]Epoch 17/25:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [35:29<20:03, 133.69s/it, loss=117, v_num=1]Epoch 17/25:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [37:35<17:49, 133.70s/it, loss=117, v_num=1]Epoch 17/25:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [37:35<17:49, 133.70s/it, loss=118, v_num=1]Epoch 17/25:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [37:37<17:49, 133.70s/it, loss=118, v_num=1]Epoch 18/25:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [37:43<17:49, 133.70s/it, loss=118, v_num=1]Epoch 18/25:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [39:49<15:36, 133.72s/it, loss=118, v_num=1]Epoch 18/25:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [39:49<15:36, 133.72s/it, loss=116, v_num=1]Epoch 18/25:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [39:51<15:36, 133.72s/it, loss=116, v_num=1]Epoch 19/25:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [39:57<15:36, 133.72s/it, loss=116, v_num=1]Epoch 19/25:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [42:02<13:22, 133.71s/it, loss=116, v_num=1]Epoch 19/25:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [42:02<13:22, 133.71s/it, loss=119, v_num=1]Epoch 19/25:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [42:05<13:22, 133.71s/it, loss=119, v_num=1]Epoch 20/25:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [42:11<13:22, 133.71s/it, loss=119, v_num=1]Epoch 20/25:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [44:16<11:08, 133.68s/it, loss=119, v_num=1]Epoch 20/25:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [44:16<11:08, 133.68s/it, loss=113, v_num=1]Epoch 20/25:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [44:18<11:08, 133.68s/it, loss=113, v_num=1]Epoch 21/25:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [44:24<11:08, 133.68s/it, loss=113, v_num=1]Epoch 21/25:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [46:30<08:54, 133.68s/it, loss=113, v_num=1]Epoch 21/25:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [46:30<08:54, 133.68s/it, loss=117, v_num=1]Epoch 21/25:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [46:32<08:54, 133.68s/it, loss=117, v_num=1]Epoch 22/25:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [46:38<08:54, 133.68s/it, loss=117, v_num=1]Epoch 22/25:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [48:44<06:41, 133.83s/it, loss=117, v_num=1]Epoch 22/25:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [48:44<06:41, 133.83s/it, loss=116, v_num=1]Epoch 22/25:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [48:46<06:41, 133.83s/it, loss=116, v_num=1]Epoch 23/25:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [48:53<06:41, 133.83s/it, loss=116, v_num=1]Epoch 23/25:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [50:57<04:27, 133.68s/it, loss=116, v_num=1]Epoch 23/25:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [50:57<04:27, 133.68s/it, loss=121, v_num=1]Epoch 23/25:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [50:59<04:27, 133.68s/it, loss=121, v_num=1]Epoch 24/25:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [51:06<04:27, 133.68s/it, loss=121, v_num=1]Epoch 24/25:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [53:11<02:13, 133.74s/it, loss=121, v_num=1]Epoch 24/25:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [53:11<02:13, 133.74s/it, loss=115, v_num=1]Epoch 24/25:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [53:13<02:13, 133.74s/it, loss=115, v_num=1]Epoch 25/25:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [53:19<02:13, 133.74s/it, loss=115, v_num=1]Epoch 25/25: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [55:24<00:00, 133.67s/it, loss=115, v_num=1]Epoch 25/25: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [55:24<00:00, 133.67s/it, loss=119, v_num=1]Epoch 25/25: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [55:27<00:00, 133.67s/it, loss=119, v_num=1]Epoch 25/25: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [55:33<00:00, 133.34s/it, loss=119, v_num=1]
correcting data
[34mINFO    [0m Input adata not setup with scvi. attempting to transfer anndata setup  
[34mINFO    [0m Using data from adata.X                                                
[34mINFO    [0m Computing library size prior per batch                                 
[34mINFO    [0m Registered keys:[1m[[0m[32m'X'[0m, [32m'batch_indices'[0m, [32m'local_l_mean'[0m, [32m'local_l_var'[0m,  
         [32m'labels'[0m[1m][0m                                                              
[34mINFO    [0m Successfully registered anndata object containing [1;36m568985[0m cells, [1;36m3000[0m   
         vars, [1;36m46[0m batches, [1;36m11[0m labels, and [1;36m0[0m proteins. Also registered [1;36m0[0m extra   
         categorical covariates and [1;36m0[0m extra continuous covariates.              
--- total time: 3415.21648478508 seconds ---


